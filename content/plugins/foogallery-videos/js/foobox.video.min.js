(function(e,o){var t={videos:{attr:"href",fullscreen:!0,regex:/(youtube(-nocookie)?\.com\/(watch|v|embed)|youtu\.be|vimeo\.com)/i,findUrl:function(e,t){if(!t)return"";var i=t.attr(e.options.videos.attr);return"string"==typeof i?o.qualifiedURL(t.attr(e.options.videos.attr)):""},autoPlay:!1,defaultWidth:640,defaultHeight:385,showCaptions:!1}};o.Item.prototype.video_id=null,o.Item.prototype.video_type=null,o.Item.prototype.video_url=null,o.Item.prototype.image_url=null,o.Item.prototype.video_valid=!1,o.VideoHandler=function(t){this.FooBox=t,this.type="video";var i=this;this.handles=function(e){var o=i.FooBox.options.videos.findUrl(i.FooBox,e),t="string"==typeof o&&null!=o.match(i.FooBox.options.videos.regex),n=i.FooBox.raise("foobox.handlesVideo",{element:e,handle:t});return n.fb.handle},this.defaults=function(e){e.width=e.width||i.FooBox.options.videos.defaultWidth,e.height=e.height||i.FooBox.options.videos.defaultHeight,e.fullscreen=e.fullscreen||i.FooBox.options.videos.fullscreen,e.social=e.social||!0,e.captions=e.captions||i.FooBox.options.videos.showCaptions,e.proportion=e.proportion||!0},this.parse=function(e){var t=new o.Item(i.type,e,this);return i.defaults(t),t.url=i.FooBox.options.videos.findUrl(i.FooBox,e)||null,t.width=e.data("width")||t.width||null,t.height=e.data("height")||t.height||null,t.image_url=e.data("image")||e.find("img").attr("src")||null,t.fullscreen="boolean"==typeof e.data("fullscreen")?e.data("fullscreen"):t.fullscreen,t.proportion="boolean"==typeof e.data("proportion")?e.data("proportion"):t.proportion,t},this.load=function(o,t,n,s){try{var a=o.url,r="https"==a.substring(0,5)?"https:":"http:";if(a.match("//(www.)?youtube|youtu.be"))o.video_id=a.match("embed")?a.split(/embed\//)[1].split('"')[0]:a.split(/v\/|v=|youtu\.be\//)[1].split(/[?&]/)[0],o.video_type="youtube",o.video_url=r+"//www.youtube.com/embed/"+o.video_id,o.video_url+=i.getUrlVar("rel",a)?"?rel="+i.getUrlVar("rel",a):"?rel=0",o.video_valid=!0;else if(a.match("//(player.)?vimeo.com")){o.video_type="vimeo";var l=a.match(/https?:\/\/(?:www\.)?vimeo\.com\/(?:(\d+)|channels\/\w+?\/(\d+))/);o.video_id=l[1]|l[2],o.video_url=r+"//player.vimeo.com/video/"+o.video_id,o.video_valid=!0}if(o.video_valid===!0){(i.FooBox.options.videos.autoPlay||"1"===i.getUrlVar("autoplay",a))&&(o.video_url=i.appendUrlVar("autoplay=1",o.video_url));var d=e('<iframe webkitAllowFullScreen mozallowfullscreen allowFullScreen style="width:100%; height:100%" frameborder="no" />').attr("src",o.video_url).addClass("fbx-item fbx-item-video");t.empty().append(d),e.isFunction(n)&&n(i.getSize(o))}else e.isFunction(s)&&s("The video ["+o.url+"] is not supported")}catch(f){e.isFunction(s)&&s(f)}},this.preload=function(){},this.getSize=function(e){return(null==e.width||null==e.height)&&(e.width=i.FooBox.options.videos.defaultWidth,e.height=i.FooBox.options.videos.defaultHeight),null!=e.width&&null!=e.height?new o.Size(e.width,e.height):new o.Size(0,0)},this.hasChanged=function(){return!1},this.getUrlVar=function(e,o){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=RegExp("[\\?&]"+e+"=([^&#]*)"),i=t.exec(o);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))},this.appendUrlVar=function(e,o){var t=-1!==o.indexOf("?")?"&":"?";return o+t+e}},o.handlers.register(o.VideoHandler,t)})(jQuery,window.FooBox);